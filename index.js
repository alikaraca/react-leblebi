"use strict";

var React = require("../react");var _extends=Object.assign||function(a){for(var c,b=1;b<arguments.length;b++)for(var d in c=arguments[b],c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d]);return a},_createClass=function(){function a(b,c){for(var e,d=0;d<c.length;d++)e=c[d],e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(b,e.key,e)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_react=require("react");Object.defineProperty(exports,"__esModule",{value:!0});function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"==typeof b||"function"==typeof b)?b:a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var Leblebi=function(a){function b(){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c.handleClick=function(d){var e=c.state.result,f=e[d].raw;c.setState({result:[],value:f})},c.handleHover=function(){var d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;c.setState({activeItemIndex:d})},c.handleChange=function(_ref){var d=_ref.target,e=d.value,f=c.state.style,_this$props=c.props,_this$props$data=_this$props.data,g=void 0===_this$props$data?[]:_this$props$data,_this$props$config=_this$props.config,h=void 0===_this$props$config?{}:_this$props$config,_this$props$className=_this$props.classNames,j=void 0===_this$props$className?{}:_this$props$className,_config$field=h.field,k=void 0!==_config$field&&_config$field,_config$limit=h.limit,l=void 0===_config$limit?10:_config$limit,m=[],n=h.lang||void 0;g.forEach(function(p){var q=p.toLocaleLowerCase(n);k&&(q=p[k].toLocaleLowerCase(n));var r=q.indexOf(e.toLocaleLowerCase(n)),s=r+e.length;if(-1<r){var u=p.slice(r,s),v=c.objectToInlineStyle(f.leblebiWord),w="leblebi-word "+(j.leblebiWord||""),x=p.replace(u,"<span class=\""+w+"\" style=\""+v+"\">"+u+"</span>");m.push({raw:p,custom:x})}return!1});var o=e.length?m.slice(0,l):[];return c.setState({result:o,activeItemIndex:-1,value:e}),null},c.handleKeyDown=function(d){var e=c.state.result,f=c.keyCode.tab,g=d.keyCode;return g===f&&e.length&&d.preventDefault(),!1},c.handleKeyUp=function(d){var e=d.keyCode,_this$keyCode=c.keyCode,f=_this$keyCode.up,g=_this$keyCode.down,h=_this$keyCode.enter,j=_this$keyCode.tab,_this$state=c.state,k=_this$state.activeItemIndex,l=_this$state.result,m=l.length-1;if(e===f)return 0<k?c.setState(function(o){return{activeItemIndex:o.activeItemIndex-1}}):c.setState({activeItemIndex:m}),null;if(e===g)return k<m?c.setState(function(o){return{activeItemIndex:o.activeItemIndex+1}}):c.setState({activeItemIndex:0}),null;if((e===h||e===j)&&-1<k){d.preventDefault();var n=l[k].raw;c.setState({activeItemIndex:-1,result:[],value:n})}return null},c.objectToInlineStyle=function(){var d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e="";return Object.keys(d).forEach(function(f){var g=f.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/\s+/g,"-").toLowerCase(),h="number"==typeof d[f]?d[f]+"px":d[f];e+=g+":"+h+";"}),e},c.state={value:"",style:{},result:[],activeItemIndex:0},c.keyCode={up:38,down:40,enter:13,tab:9},c}return _inherits(b,a),_createClass(b,[{key:"componentWillMount",value:function componentWillMount(){var e={leblebi:{display:"flex",flexDirection:"column"},leblebiInput:{},leblebiResult:{background:"#fff",border:"1px solid #ccc",padding:1},leblebiItem:{cursor:"pointer",padding:6},leblebiItemActive:{background:"#2666b9",color:"#fff"},leblebiWord:{padding:"3px 1px 0px",border:"1px solid #ffd94f",color:"#f9a500",background:"#ffefd3",borderRadius:2,fontWeight:"normal",margin:"0px 1px",boxShadow:"1px 1px 1px -1px #000000"}},_props=this.props,_props$style=_props.style,c=void 0===_props$style?{}:_props$style,_props$config=_props.config,d=void 0===_props$config?{}:_props$config,f=d.noDefaultStyle?{}:_extends({},e);Object.keys(c).forEach(function(g){f[g]=_extends({},e[g],c[g])}),this.state.style=f}},{key:"render",value:function render(){var h=this,_state=this.state,c=_state.style,d=_state.value,e=_state.result,f=_state.activeItemIndex,_props$classNames=this.props.classNames,g=void 0===_props$classNames?{}:_props$classNames;return React.createElement(_react.Fragment,null,React.createElement("div",{className:"leblebi "+(g.leblebi||""),style:c.leblebi},React.createElement("input",{className:"leblebi-input "+(g.leblebiInput||""),onChange:this.handleChange,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,value:d,type:"text",style:c.leblebiInput}),0<e.length&&React.createElement("div",{className:"leblebi-result "+(g.leblebiResult||""),style:c.leblebiResult},e.map(function(j,k){var l={},m="leblebi-item "+(g.leblebiItem||"");return f===k&&(l=c.leblebiItemActive,m+=" leblebi-item-active "+(g.leblebiItemActive||"")),React.createElement("div",{key:j.raw,index:k,className:m,onClick:function onClick(){return h.handleClick(k)},onFocus:function onFocus(){return h.handleHover(k)},onBlur:function onBlur(){return h.handleHover()},onMouseOver:function onMouseOver(){return h.handleHover(k)},onMouseOut:function onMouseOut(){return h.handleHover()},style:_extends({},l,c.leblebiItem),dangerouslySetInnerHTML:{__html:j.custom}})}))))}}]),b}(_react.Component);exports.default=Leblebi;